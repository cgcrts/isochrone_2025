<!doctype html>
<html lang="fr">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Carte isochrone interactive des transports publics suisses</title>

        <!-- scripts -->
        <script src="https://rtsinfo-data.s3.amazonaws.com/js_scripts/autoresize.js"></script>

        <!-- styles -->
        <link rel="icon" type="image/ico" href="./assets/images/favicon.ico" />
        <link rel="stylesheet" type="text/css" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
        <link rel="stylesheet" type="text/css" href="styles/app.css" />
        <link rel="stylesheet" type="text/css" href="styles/about.css" />
        <link rel="stylesheet" type="text/css" href="styles/form.css" />
        <link rel="stylesheet" type="text/css" href="styles/legend.css" />
    </head>

    <body class="no-scroll">
        <div class="appContent">
            <div class="formContainer">
                <form id="form">
                    <div class="geoOptions">
                        <label>Wahl des Ausgangspunkts</label>
                        <div class="formCheckbox geoOptionsCheckbox">
                            <label for="geoOptionsSelect" class="">
                                <img src="assets/images/markerSD.png" alt="marker">Auf der Karte
                            </label>
                            <input type="checkbox" class="formCheckboxInput" id="geoOptionsSelect">
                            <label for="geoOptionsSelect" class="selected">
                                <img src="assets/images/logo_train.png" alt="train">Bahnhof
                            </label>
                        </div>
                    </div>
                    <div class="formGrid" id="simpleOptions">
                        <div class="form-group" id="ctrls-point-1">
                            <label>Ausgangspunkt Nr. 1</label>
                            <div class="locationInput">
                                <button class="btn btn-secondary hidden" id="select-origin-point-1" type="button">
                                    <span class="btn-content-initial">
                                        <img src="./assets/images/markerSD.png" width="15" alt="origin point"/>
                                        Den Ausgangspunkt wählen
                                    </span>
                                    <span class="btn-content-active hidden">Auf die Karte klicken</span>
                                    <span class="btn-content-selected hidden"></span>

                                </button>
                                <div class="input-wrapper">
                                    <input id="search-1" type="text" placeholder="Einen Bahnhof suchen..." autocomplete="off"/>
                                    <span class="clearBtn" id="clearBtn-1">✕</span>
                                    <div id="results-1" class="results"></div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group disabled hidden" id="ctrls-point-2">
                            <label>Ausgangspunkt Nr. 2 (optional)</label>
                            <div class="locationInput">
                                <button disabled class="btn btn-secondary hidden" id="select-origin-point-2" type="button">
                                    <span class="btn-content-initial">
                                        <img src="./assets/images/markerRedSD.png" width="15" alt="origin point"/>
                                        Den Ausgangspunkt wählen
                                    </span>
                                    <span class="btn-content-active hidden">Auf die Karte klicken</span>
                                    <span class="btn-content-selected hidden"></span>
                                </button>
                                <div class="input-wrapper">
                                    <input id="search-2" type="text" placeholder="Einen Bahnhof suchen..." autocomplete="off"/>
                                    <span class="clearBtn" id="clearBtn-2">✕</span>
                                    <div id="results-2" class="results"></div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="time-limit">Zeitbudget (in Minuten)</label>
                            <input type="number" id="time-limit" min="10" max="480" value="60" required />
                        </div>
                    </div>

                    <div class="formCheckbox advancedOptionsCheckbox">
                        <input type="checkbox" class="formCheckboxInput" id="advancedOptionsSelect">
                        <label for="advancedOptionsSelect">Die Abfahrtszeit ändern</label>
                    </div>

                    <div class="formGrid" id="advancedOptions">
                        <div class="form-group">
                            <label for="departure-at">Datum und Zeit der Abfahrt</label>
                            <input type="datetime-local" id="departure-at" required />
                        </div>

                        <div class="form-group">
                            <label for="isochrone-interval">Abstand zwischen den Isochronen</label>
                            <select id="isochrone-interval" required></select>
                        </div>
                        <div class="form-group">
                            <label>Optimale Abfahrtszeit</label>
                            <div class="formCheckbox">
                                <input type="checkbox" class="formCheckboxInput" id="find-optimal" />
                                <label for="find-optimal">Abfahrt zwischen -30' und +30'</label>
                            </div>
                            <div class="optimalTimeLabel hidden" id="optimal-legend-1">
                                Optimale Abfahrt Ort 1
                                <span class="optimal-time">20:00</span>
                            </div>
                            <div class="optimalTimeLabel hidden" id="optimal-legend-2">
                                Optimale Abfahrt Ort 2
                                <span class="optimal-time">22:30</span>
                            </div>
                        </div>

                    </div>

                    <div class="submitButtonContainer">
                        <button class="btn" id="submit-button" type="submit" disabled>
                            <img src="./assets/images/target.png" width="20" height="20" alt="target"/>
                            Berechnen
                        </button>
                    </div>

                </form>
            </div>

            <div class="map-container">
                <div id="map"></div>

                <!-- Toaster -->
                <div id="toast" class="hidden">
                    <div class="loader-container">
                        <div class="loader"></div>
                    </div>
                    <div id="toast-content">
                        <!-- <div id="toast-spacer"></div> -->
                        <p>Berechnung der Isochronen läuft...</p>
                        <p class="hidden noline">Berechnung immer noch im Gang...</p>
                        <p class="hidden noline">Noch ein paar Sekunden...</p>
                        <p class="hidden noline">Es ist lang...</p>
                        <p class="hidden noline">Es ist lang !</p>
                        <p class="hidden noline">Es ist sehr lang...</p>
                        <!-- <p class="hidden">I'm an awesome toast!</p> -->
                        <!-- <p class="hidden">I'm an awesome toast!</p> -->
                    </div>
                </div>
            </div>

            <!-- Legend -->

            <div class="legendContainer hidden" id="legendContainer">
                <div class="legendDateTime">
                    Ausgewählter Zeitpunkt:
                    <span id="legendDate"></span> - <span id="legendTime"></span>
                </div>
                <div class="legendLabels">
                    <div class="legendLabel">Reisezeit (in Minuten) und</div>
                    <div class="legendLabel">abgedeckte Fläche (in km²)</div>
                </div>

                <div class="legendContent">
                    <div class="legendBarLabel">
                        Ausgangspunkt 1
                    </div>
                    <div class="legendBar">
                        <div class="legendV2" id="legend"></div>
                        <div class="legendUnits">
                            <div class="legend-entry">
                                <div class="timelimit">min</div>
                                <div class="area">km²</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="legendContent hidden">
                    <div class="legendBarLabel">
                        Ausgangspunkt 2
                    </div>
                    <div class="legendBar">
                        <div class="legendV2" id="legend-2"></div>
                        <div class="legendUnits">
                            <div class="legend-entry">
                                <div class="timelimit">min</div>
                                <div class="area">km²</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <button class="btn btn-secondary about" onclick="handleAboutButton()">Weitere Informationen</button>

            <div id="aboutContainer" class="hidden" >
                <div id="aboutContent">
                    <div class="aboutCloseButton" onclick="handleCloseAbout()">
                        <svg width="24px" height="24px" viewBox="0 0 24 24" fill="#804a3e" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.29289 5.29289C5.68342 4.90237 6.31658 4.90237 6.70711 5.29289L12 10.5858L17.2929 5.29289C17.6834 4.90237 18.3166 4.90237 18.7071 5.29289C19.0976 5.68342 19.0976 6.31658 18.7071 6.70711L13.4142 12L18.7071 17.2929C19.0976 17.6834 19.0976 18.3166 18.7071 18.7071C18.3166 19.0976 17.6834 19.0976 17.2929 18.7071L12 13.4142L6.70711 18.7071C6.31658 19.0976 5.68342 19.0976 5.29289 18.7071C4.90237 18.3166 4.90237 17.6834 5.29289 17.2929L10.5858 12L5.29289 6.70711C4.90237 6.31658 4.90237 5.68342 5.29289 5.29289Z" fill="fill"/></svg>
                    </div>
                    <div class="aboutTitle">
                        Berechnung der Isochronen
                    </div>
                    <div class="aboutText">
                        <a href="https://iso.hepiapp.ch" target="_blank">"Isochrones"</a> ist ein interaktives Tool zur Visualisierung von
                        <a href="https://de.wikipedia.org/wiki/Erreichbarkeitskarte" target="_blank">Isochronenkarten</a>
                        in der Schweiz. Die Plattform ermöglicht es, die zu Fuss und mit den öffentlichen Verkehrsmitteln der Schweiz erreichbaren Gebiete zu berechnen und zu vergleichen, ausgehend von einem Ausgangsort und einer Abfahrtszeit und dem zur Verfügung stehenden Zeitbudget.
                    </div>
                    <div class="aboutTitle">
                        Quelle der Daten
                    </div>
                    <div class="aboutText">
                        Die Daten stammen aus den
                        <a href="https://opendata.swiss/de/dataset/fahrplan-2026-hrdf-format-5-4" target="_blank">Fahrplänen</a>
                        des öffentlichen Verkehrs der Schweiz.
                    </div>
                    <div class="aboutTitle">
                        Quellcode
                    </div>
                    <div class="aboutText">
                        <div>
                            <a href="https://github.com/florianburgener/hrdf-parser" target="_blank">Parser HRDF</a>
                        </div>
                        <div>
                            <a href="https://github.com/florianburgener/hrdf-routing-engine" target="_blank">Planificateur de trajets</a>
                        </div>
                        <div>
                            <a href="https://github.com/florianburgener/interactive-isochrone-map" target="_blank">Site web</a>
                        </div>
                    </div>
                    <div class="aboutTitle">
                        Mitarbeit
                    </div>
                    <div class="aboutText">
                        <a href="https://github.com/florianburgener" target="_blank">F. Burgener</a>, A. Durgnat,
                        <a href="https://github.com/Foebus" target="_blank">M. Gay-Balmaz</a>,
                        <a href="https://people.hes-so.ch/en/profile/4037691745-orestis-malaspinas" target="_blank">O. Malaspinas</a>.
                        <a href="https://www.hesge.ch/hepia" target="_blank">Haute école du paysage d'ingénierie et d'architecture</a>
                    </div>
                </div>
            </div>
        </div>

        <script
            type="text/javascript"
            src="https://unpkg.com/leaflet/dist/leaflet.js"
        ></script>
        <script
            type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"
        ></script>
        <script
            type="text/javascript"
            src="https://cdn.jsdelivr.net/npm/@turf/turf@7/turf.min.js"
        ></script>
        <script type="text/javascript" src="script.js"></script>
    </body>
</html>
